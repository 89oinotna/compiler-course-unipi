This example is inspired at the Chapter 18 of "Real World OCaml".